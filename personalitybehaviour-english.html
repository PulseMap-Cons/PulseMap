<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personality Behaviour Analysis - English</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for the Inter font */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Red highlight for unanswered questions on submission error */
        .unanswered-question {
            border: 2px solid #ef4444; /* Red border */
            background-color: #fef2f2; /* Light red background */
        }
        /* Subtle highlight for the next question to focus on during filling */
        .next-focus-question {
            border: 2px solid #f97316; /* Orange border */
            background-color: #fff7ed; /* Light orange background */
        }
        /* Style for real-time error message */
        .question-error-message {
            color: #dc2626; /* Red text */
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.5rem;
            text-align: left;
        }
        /* Styles for the custom message box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none; /* Hidden by default */
            font-weight: bold;
            text-align: center;
        }
        .message-box.success {
            background-color: #d1fae5; /* green-100 */
            color: #065f46; /* green-800 */
            border: 1px solid #34d399; /* green-400 */
        }
        .message-box.error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
            border: 1px solid #f87171; /* red-400 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <!-- Header Section -->
    <header class="bg-white shadow-md py-4">
        <div class="container mx-auto px-4 flex justify-center items-center">
            <!-- Business Logo as Title -->
            <img src="https://i.imgur.com/Zx34Iky.png" alt="Your Business Logo" class="h-24 sm:h-32 md:h-40 w-full object-contain rounded-lg shadow-sm">
        </div>
    </header>

    <!-- Custom Message Box -->
    <div id="messageBox" class="message-box"></div>

    <!-- Main Content Section for the Assessment -->
    <main class="flex-grow container mx-auto px-4 py-8 flex flex-col items-center justify-center">
        <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-4 leading-tight">
                Personality Behaviour Analysis
            </h1>
            <h2 class="text-2xl md:text-3xl font-semibold text-indigo-600 mb-6">
                English Version
            </h2>
            <p class="text-lg text-gray-700 mb-8 text-left">
                Welcome to the Personality Behaviour Analysis. Answer each question by choosing the option that best describes you. Each answer contributes to one of the personality preference dimensions. Your responses will help provide insights into your unique personality profile.
            </p>

            <!-- User Information Form -->
            <div class="mb-8 p-6 bg-blue-50 rounded-lg shadow-inner text-left">
                <h3 class="text-xl font-semibold text-blue-800 mb-4">Your Details</h3>
                <div class="mb-4">
                    <label for="userName" class="block text-gray-700 text-sm font-bold mb-2">Your Name:</label>
                    <input type="text" id="userName" name="userName" placeholder="Enter your full name"
                           class="shadow appearance-none border rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:border-indigo-500" required>
                </div>
                <!-- Email input field removed as per user request -->
            </div>

            <!-- Assessment Questions Form -->
            <form id="assessmentForm" class="border-t border-gray-200 pt-8 mt-8 text-left">

                <!-- Question 1 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q1-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">1. When you are stressed, what helps you most?</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q1-a" name="q1" value="A" class="mr-2">
                        <label for="q1-a" class="text-gray-700">A) Talking to friends or family about it</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q1-b" name="q1" value="B" class="mr-2">
                        <label for="q1-b" class="text-gray-700">B) Taking time alone to think and process</label>
                    </div>
                    <div id="q1-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 2 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q2-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">2. At a party or social event:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q2-a" name="q2" value="A" class="mr-2">
                        <label for="q2-a" class="text-gray-700">A) You chat with lots of people and feel energized</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q2-b" name="q2" value="B" class="mr-2">
                        <label for="q2-b" class="text-gray-700">B) You stick with a few people and feel drained after a while</label>
                    </div>
                    <div id="q2-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 3 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q3-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">3. When solving a problem:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q3-a" name="q3" value="A" class="mr-2">
                        <label for="q3-a" class="text-gray-700">A) You think out loud and discuss it with others</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q3-b" name="q3" value="B" class="mr-2">
                        <label for="q3-b" class="text-gray-700">B) You think it through thoroughly before sharing</label>
                    </div>
                    <div id="q3-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 4 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q4-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">4. Your ideal weekend would be:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q4-a" name="q4" value="A" class="mr-2">
                        <label for="q4-a" class="text-gray-700">A) Various activities with friends and family</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q4-b" name="q4" value="B" class="mr-2">
                        <label for="q4-b" class="text-gray-700">B) Quiet time at home with a good book or hobby</label>
                    </div>
                    <div id="q4-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 5 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q5-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">5. When meeting new people:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q5-a" name="q5" value="A" class="mr-2">
                        <label for="q5-a" class="text-gray-700">A) You're comfortable initiating conversation</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q5-b" name="q5" value="B" class="mr-2">
                        <label for="q5-b" class="text-gray-700">B) You prefer them to make the first move</label>
                    </div>
                    <div id="q5-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 6 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q6-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">6. When starting a new project:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q6-a" name="q6" value="A" class="mr-2">
                        <label for="q6-a" class="text-gray-700">A) You begin with concrete steps and practical details</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q6-b" name="q6" value="B" class="mr-2">
                        <label for="q6-b" class="text-gray-700">B) You start with the big picture and possibilities</label>
                    </div>
                    <div id="q6-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 7 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q7-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">7. You prefer instructions that:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q7-a" name="q7" value="A" class="mr-2">
                        <label for="q7-a" class="text-gray-700">A) Are step-by-step and specific</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q7-b" name="q7" value="B" class="mr-2">
                        <label for="q7-b" class="text-gray-700">B) Explain the goal so you can find your own way</label>
                    </div>
                    <div id="q7-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 8 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q8-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">8. When telling a story:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q8-a" name="q8" value="A" class="mr-2">
                        <label for="q8-a" class="text-gray-700">A) You include accurate facts and details</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q8-b" name="q8" value="B" class="mr-2">
                        <label for="q8-b" class="text-gray-700">B) You focus on the meaning and emotional impact</label>
                    </div>
                    <div id="q8-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 9 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q9-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">9. You find it more interesting to talk about:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q9-a" name="q9" value="A" class="mr-2">
                        <label for="q9-a" class="text-gray-700">A) Practical matters and real-life experiences</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q9-b" name="q9" value="B" class="mr-2">
                        <label for="q9-b" class="text-gray-700">B) Ideas, theories, and future possibilities</label>
                    </div>
                    <div id="q9-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 10 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q10-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">10. When making a decision, you usually:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q10-a" name="q10" value="A" class="mr-2">
                        <label for="q10-a" class="text-gray-700">A) Rely on what worked in the past</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q10-b" name="q10" value="B" class="mr-2">
                        <label for="q10-b" class="text-gray-700">B) Explore new and innovative options</label>
                    </div>
                    <div id="q10-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 11 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q11-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">11. When resolving conflict:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q11-a" name="q11" value="A" class="mr-2">
                        <label for="q11-a" class="text-gray-700">A) You focus on facts and logical solutions</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q11-b" name="q11" value="B" class="mr-2">
                        <label for="q11-b" class="text-gray-700">B) You focus on people's feelings and relationships</label>
                    </div>
                    <div id="q11-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 12 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q12-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">12. When making a decision, you prioritize:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q12-a" name="q12" value="A" class="mr-2">
                        <label for="q12-a" class="text-gray-700">A) Objective analysis and consistency</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q12-b" name="q12" value="B" class="mr-2">
                        <label for="q12-b" class="text-gray-700">B) Personal values and impact on people</label>
                    </div>
                    <div id="q12-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 13 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q13-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">13. When giving feedback, you tend to be:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q13-a" name="q13" value="A" class="mr-2">
                        <label for="q13-a" class="text-gray-700">A) Direct and honest, even if it's difficult</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q13-b" name="q13" value="B" class="mr-2">
                        <label for="q13-b" class="text-gray-700">B) Gentle and diplomatic, to protect feelings</label>
                    </div>
                    <div id="q13-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 14 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q14-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">14. You value people who are:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q14-a" name="q14" value="A" class="mr-2">
                        <label for="q14-a" class="text-gray-700">A) Fair and consistent</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q14-b" name="q14" value="B" class="mr-2">
                        <label for="q14-b" class="text-gray-700">B) Empathetic and understanding</label>
                    </div>
                    <div id="q14-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 15 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q15-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">15. In a team environment, you focus on:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q15-a" name="q15" value="A" class="mr-2">
                        <label for="q15-a" class="text-gray-700">A) Efficiency and achieving results</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q15-b" name="q15" value="B" class="mr-2">
                        <label for="q15-b" class="text-gray-700">B) Ensuring everyone feels included and valued</label>
                    </div>
                    <div id="q15-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 16 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q16-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">16. Your workspace is typically:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q16-a" name="q16" value="A" class="mr-2">
                        <label for="q16-a" class="text-gray-700">A) Neat and organized</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q16-b" name="q16" value="B" class="mr-2">
                        <label for="q16-b" class="text-gray-700">B) A bit messy, but you know where everything is</label>
                    </div>
                    <div id="q16-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 17 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q17-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">17. When planning a vacation, you prefer:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q17-a" name="q17" value="A" class="mr-2">
                        <label for="q17-a" class="text-gray-700">A) A detailed itinerary and advance bookings</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q17-b" name="q17" value="B" class="mr-2">
                        <label for="q17-b" class="text-gray-700">B) To see what happens and decide spontaneously</label>
                    </div>
                    <div id="q17-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 18 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q18-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">18. You prefer work that has:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q18-a" name="q18" value="A" class="mr-2">
                        <label for="q18-a" class="text-gray-700">A) Clear deadlines and structures</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q18-b" name="q18" value="B" class="mr-2">
                        <label for="q18-b" class="text-gray-700">B) Flexibility and open-ended options</label>
                    </div>
                    <div id="q18-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 19 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q19-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">19. When approaching a task, you:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q19-a" name="q19" value="A" class="mr-2">
                        <label for="q19-a" class="text-gray-700">A) Start early to finish on time</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q19-b" name="q19" value="B" class="mr-2">
                        <label for="q19-b" class="text-gray-700">B) Work best under pressure closer to the deadline</label>
                    </div>
                    <div id="q19-error" class="question-error-message hidden"></div>
                </div>

                <!-- Question 20 -->
                <div class="question-block mb-6 p-4 bg-gray-50 rounded-lg shadow-sm" id="q20-block">
                    <p class="text-lg font-semibold text-gray-800 mb-3">20. You feel most comfortable when:</p>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q20-a" name="q20" value="A" class="mr-2">
                        <label for="q20-a" class="text-gray-700">A) Plans are made and things are settled</label>
                    </div>
                    <div class="mb-2 flex items-center">
                        <input type="radio" id="q20-b" name="q20" value="B" class="mr-2">
                        <label for="q20-b" class="text-gray-700">B) Options are kept open for change</label>
                    </div>
                    <div id="q20-error" class="question-error-message hidden"></div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 mt-8">
                    Submit Assessment
                </button>
            </form>

            <!-- Results Display Area -->
            <div id="resultsDisplay" class="hidden bg-blue-50 p-6 rounded-lg shadow-md mt-8 text-center">
                <h3 class="text-2xl font-bold text-blue-800 mb-4">Your Personality Type:</h3>
                <p id="personalityType" class="text-4xl font-extrabold text-indigo-700 mb-4"></p>
                <p id="resultDetails" class="text-lg text-blue-700"></p>
                <div class="mt-6 text-left">
                    <h4 class="text-xl font-semibold text-blue-800 mb-2">Personality Preference Overview:</h4>
                    <p class="text-lg text-blue-700 mb-2"><strong>E/I (Extraversion / Introversion):</strong> How you gain and process energy.</p>
                    <p class="text-lg text-blue-700 mb-2"><strong>S/N (Sensing / Intuition):</strong> How you gather and interpret information.</p>
                    <p class="text-lg text-blue-700 mb-2"><strong>T/F (Thinking / Feeling):</strong> How you make decisions.</p>
                    <p class="text-lg text-blue-700 mb-2"><strong>J/P (Judging / Perceiving):</strong> How you prefer to live your outer life.</p>
                </div>
            </div>

            <!-- Back to Homepage Button -->
            <div class="mt-10">
                <a href="index.html" class="inline-block bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Back to Homepage
                </a>
            </div>
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">&copy; 2025 Your Business. All rights reserved.</p>
        </div>
    </footer>

    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        // Initialize EmailJS with your Public Key
        (function() {
            try {
                emailjs.init("Pmd3fgupxDv25ALjZ"); // Your EmailJS Public Key
                console.log("EmailJS initialized successfully.");
            } catch (e) {
                console.error("Error initializing EmailJS:", e);
            }
        })();
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('assessmentForm');
            const resultsDisplay = document.getElementById('resultsDisplay');
            const personalityTypeElement = document.getElementById('personalityType');
            const resultDetailsElement = document.getElementById('resultDetails');
            const userNameInput = document.getElementById('userName');
            // userEmailInput is removed as per user request
            const questionBlocks = document.querySelectorAll('.question-block');
            const messageBox = document.getElementById('messageBox'); // Get the message box element

            // Function to show messages
            function showMessage(message, type) {
                console.log('showMessage called:', message, type); // DEBUG: Confirm showMessage is called
                messageBox.textContent = message;
                messageBox.className = 'message-box'; // Reset classes
                messageBox.classList.add(type); // Add success or error class
                messageBox.style.display = 'block'; // Show the message box

                // Hide message after 5 seconds
                setTimeout(() => {
                    messageBox.style.display = 'none';
                    console.log('Message box hidden.'); // DEBUG: Confirm message box hides
                }, 5000);
            }

            // Function to validate if a question is answered
            function isQuestionAnswered(questionName) {
                const radios = document.querySelectorAll(`input[name="${questionName}"]:checked`);
                return radios.length > 0;
            }

            // Function to display/hide real-time error message for a specific question
            function updateQuestionError(questionName) {
                const questionNumber = questionName.replace('q', '');
                const errorDiv = document.getElementById(`q${questionNumber}-error`);
                if (!errorDiv) return;

                if (!isQuestionAnswered(questionName)) {
                    errorDiv.textContent = "Please select an answer.";
                    errorDiv.classList.remove('hidden');
                } else {
                    errorDiv.classList.add('hidden');
                    errorDiv.textContent = "";
                }
            }

            // Function to find the next unanswered question and scroll to it, applying subtle highlight
            function findAndScrollToNextUnanswered() {
                questionBlocks.forEach(block => {
                    block.classList.remove('next-focus-question');
                });

                for (let i = 1; i <= 20; i++) {
                    const questionName = `q${i}`;
                    const questionBlock = document.getElementById(`q${i}-block`);
                    if (!isQuestionAnswered(questionName) && !questionBlock.classList.contains('unanswered-question')) {
                        questionBlock.classList.add('next-focus-question');
                        questionBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        updateQuestionError(questionName); // Show real-time error
                        return true;
                    }
                }
                return false;
            }

            // Add change event listeners to all radio buttons for real-time validation and scrolling
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', (event) => {
                    const questionName = event.target.name;
                    updateQuestionError(questionName); // Update error for this question
                    findAndScrollToNextUnanswered(); // Scroll to next unanswered
                });
            });

            form.addEventListener('submit', (event) => {
                event.preventDefault(); // Prevent default form submission
                console.log('Form submitted.'); // DEBUG: Confirm form submission event fired

                const userName = userNameInput.value.trim();
                // userEmail is not collected from client

                // Basic validation for name
                if (!userName) {
                    showMessage("Please enter your name.", "error");
                    userNameInput.focus();
                    return;
                }
                console.log('Name validated.'); // DEBUG: Confirm validation passed

                let allQuestionsAnswered = true;
                let firstUnansweredBlock = null;

                // Clear previous error highlights
                questionBlocks.forEach(block => {
                    block.classList.remove('unanswered-question', 'next-focus-question');
                    const questionNumber = block.id.replace('q', '').replace('-block', '');
                    const errorDiv = document.getElementById(`q${questionNumber}-error`);
                    if (errorDiv) {
                        errorDiv.classList.add('hidden');
                        errorDiv.textContent = "";
                    }
                });

                // Validate all questions and highlight if unanswered
                for (let i = 1; i <= 20; i++) {
                    const questionName = `q${i}`;
                    const questionBlock = document.getElementById(`q${i}-block`);
                    if (!isQuestionAnswered(questionName)) {
                        allQuestionsAnswered = false;
                        questionBlock.classList.add('unanswered-question');
                        if (!firstUnansweredBlock) {
                            firstUnansweredBlock = questionBlock;
                        }
                        updateQuestionError(questionName); // Show error on submit for unanswered
                    }
                }

                if (!allQuestionsAnswered) {
                    if (firstUnansweredBlock) {
                        firstUnansweredBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    resultsDisplay.classList.remove('hidden', 'bg-blue-50', 'border-blue-400', 'text-blue-700');
                    resultsDisplay.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                    personalityTypeElement.textContent = "Error!";
                    resultDetailsElement.textContent = "Please answer all questions before submitting.";
                    showMessage("Please answer all questions before submitting.", "error"); // Ensure message shows for unanswered questions
                    return;
                }
                console.log('All questions answered.'); // DEBUG: Confirm all questions are answered


                // If all valid, hide any previous error message
                resultsDisplay.classList.add('hidden');

                // Calculate scores
                let eScore = 0, iScore = 0;
                let sScore = 0, nScore = 0;
                let tScore = 0, fScore = 0;
                let jScore = 0, pScore = 0;

                // Mapping from question number to personality dimension
                const eiQuestions = [1, 2, 3, 4, 5];
                const snQuestions = [6, 7, 8, 9, 10];
                const tfQuestions = [11, 12, 13, 14, 15];
                const jpQuestions = [16, 17, 18, 19, 20];

                // Process each question
                for (let i = 1; i <= 20; i++) {
                    const selectedValue = document.querySelector(`input[name="q${i}"]:checked`).value;

                    if (eiQuestions.includes(i)) {
                        if (selectedValue === 'A') eScore++;
                        else if (selectedValue === 'B') iScore++;
                    } else if (snQuestions.includes(i)) {
                        if (selectedValue === 'A') sScore++;
                        else if (selectedValue === 'B') nScore++;
                    } else if (tfQuestions.includes(i)) {
                        if (selectedValue === 'A') tScore++;
                        else if (selectedValue === 'B') fScore++;
                    } else if (jpQuestions.includes(i)) {
                        if (selectedValue === 'A') jScore++;
                        else if (selectedValue === 'B') pScore++;
                    }
                }

                // Determine personality type letters
                const ei = eScore > iScore ? 'E' : 'I';
                const sn = sScore > nScore ? 'S' : 'N';
                const tf = tScore > fScore ? 'T' : 'F';
                const jp = jScore > pScore ? 'J' : 'P';

                const personalityType = `${ei}${sn}${tf}${jp}`;

                // Display results
                resultsDisplay.classList.remove('hidden', 'bg-red-100', 'border-red-400', 'text-red-700');
                resultsDisplay.classList.add('bg-blue-50', 'border-blue-400', 'text-blue-700');
                personalityTypeElement.textContent = personalityType;
                resultDetailsElement.innerHTML = `<p>Based on your answers, your personality type is <strong>${personalityType}</strong>.</p>`;

                // Add detailed scores
                resultDetailsElement.innerHTML += `
                    <p class="mt-4"><strong>Detailed Scores:</strong></p>
                    <ul class="list-disc list-inside mx-auto max-w-md">
                        <li><strong>Extraversion (E) / Introversion (I):</strong> E: ${eScore}, I: ${iScore}</li>
                        <li><strong>Sensing (S) / Intuition (N):</strong> S: ${sScore}, N: ${nScore}</li>
                        <li><strong>Thinking (T) / Feeling (F):</strong> T: ${tScore}, F: ${fScore}</li>
                        <li><strong>Judging (J) / Perceiving (P):</strong> J: ${jScore}, P: ${pScore}</li>
                    </ul>
                `;

                // Scroll to results
                resultsDisplay.scrollIntoView({ behavior: 'smooth', block: 'start' });

                // Send email via EmailJS
                const serviceID = 'service_n3for6s'; // Your EmailJS Service ID
                const templateID = 'template_kifuzeo'; // Your EmailJS Template ID

                const templateParams = {
                    user_name: userName,
                    // user_email is removed from templateParams
                    personality_type: personalityType,
                    ei_score: `E: ${eScore}, I: ${iScore}`,
                    sn_score: `S: ${sScore}, N: ${nScore}`,
                    tf_score: `T: ${tScore}, F: ${fScore}`,
                    jp_score: `J: ${jScore}, P: ${pScore}`
                };

                console.log('Attempting to send email with params:', templateParams); // DEBUG: Confirm email send attempt
                emailjs.send(serviceID, templateID, templateParams)
                    .then(function(response) {
                        console.log('EmailJS SUCCESS!', response.status, response.text); // DEBUG: Confirm EmailJS success
                        // Updated success message to reflect that results are submitted, not necessarily sent to client's email
                        showMessage('Your assessment results have been submitted successfully!', 'success');
                    }, function(error) {
                        console.log('EmailJS FAILED...', error); // DEBUG: Confirm EmailJS failure
                        showMessage('Failed to submit assessment results. Please try again later.', 'error');
                    });
            });
        });
    </script>
</body>
</html>
